(this.webpackJsonpmonitoing=this.webpackJsonpmonitoing||[]).push([[0],{14:function(e,t,a){e.exports=a(25)},21:function(e,t,a){},25:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(12),s=a.n(l),i=(a(19),a(20),a(21),a(2)),c=a(1),o=a(3),m=a(4),u=a(13),d=a(7),f=a(8),v=function(){function e(t){var a=t.eventManager,n=t.itemLabel,r=void 0===n?"Item":n,l=t.basicEventHandlerItemPrefix,s=void 0===l?"item":l,i=t.fetchUrlPath,c=void 0===i?"/items":i;Object(d.a)(this,e),this.itemLabel=r,this.stateKey=r+"State",this.eventHandlerItemPrefix=s,this.fetchUrlPath=c,this.globalState={},this.setGlobalState=function(e){Object(u.a)(e)},this.eventManager=a,a.subscribe(this)}return Object(f.a)(e,[{key:"initializeGlobalState",value:function(e,t){this.globalState=e,this.setGlobalState=t}},{key:"eventHandler",value:function(e){if(e.message===this.eventHandlerItemPrefix+" deleted"){var t=e.data.id,a=0,n=this.items().filter((function(e,n){return e.id===t&&(a=n),e.id!==t}));this.setItems(n),this.items().length>0&&(a=this.items().length<=a?a-1:a,this.setState({active:this.items()[a].id}))}if(e.message===this.eventHandlerItemPrefix+" added"&&this.setItems([].concat(Object(m.a)(this.items()),[e.data])),e.message===this.eventHandlerItemPrefix+" edited"&&this.updateItem(e.data.id),e.message===this.eventHandlerItemPrefix+" updated"){var r=e.data.id;if(this.state().active===r)this.updateItem(r);else{var l=this.items(),s=l.findIndex((function(e){return e.id===r}));l[s].last_reading&&(l[s].last_reading=null),this.setItems(l)}}}},{key:"state",value:function(){return null==this.globalState[this.stateKey]&&(this.globalState[this.stateKey]={}),this.globalState[this.stateKey]}},{key:"setState",value:function(e){var t=this.state(),a={};a[this.stateKey]=Object(c.a)({},t,{},e),this.setGlobalState(a)}},{key:"activeState",value:function(){var e=this.state().active;return null==e?{}:null==this.globalState[e]?(this.globalState[e]={},{}):this.globalState[e]}},{key:"setActiveState",value:function(e){var t=this.state().active;if(null!=t){var a={};a[t]=Object(c.a)({},this.activeState(),{},e),this.setGlobalState(a)}}},{key:"items",value:function(){return null==this.globalState[this.itemLabel]?(this.globalState[this.itemLabel]=[],this.updateItems(),[]):this.globalState[this.itemLabel]}},{key:"setItems",value:function(e){var t={};t[this.itemLabel]=e,this.setGlobalState(t)}},{key:"item",value:function(){var e=this,t=this.items().find((function(t){return t.id===e.state().active}));return null==t&&(t={}),t}},{key:"setItem",value:function(e){var t=this.items(),a=t.findIndex((function(t){return t.id===e.id}));t[a]=e,this.setItems(t)}},{key:"updateItem",value:function(e){var t=this;if(null!=e){var a="."+"".concat(this.fetchUrlPath,"/").concat(e);fetch(a).then((function(e){return e.json()})).then((function(e){t.setItem(e)}))}}},{key:"updateItems",value:function(){var e=this,t="."+this.fetchUrlPath;fetch(t).then((function(e){return e.json()})).then((function(t){e.setItems(t),""===e.state().active&&e.items().length>0&&e.setState({active:"id"in e.items()[0]?e.items()[0].id:""})}))}},{key:"refreshItem",value:function(e){var t=this;if(null!=e){var a="."+"".concat(this.fetchUrlPath,"/").concat(e,"/update");return fetch(a).then((function(e){return e.json()})).then((function(e){t.setItem(Object(c.a)({},t.item(),{last_reading:e}))}))}}},{key:"deleteItem",value:function(e){if(null!=e){var t="."+"".concat(this.fetchUrlPath,"/").concat(e);fetch(t,{method:"DELETE",data:{}})}}}]),e}();function p(e,t){return function(a){a.preventDefault();var n=a.nativeEvent.target,r=Object(c.a)({},e),l=n.value;n.dataset.factor&&null!=l&&(l*=n.dataset.factor),r[n.name]=l,t(r)}}function b(e){return r.a.createElement("div",{className:"form-group"},"label"in e?r.a.createElement("label",null,e.label||"label"):null,r.a.createElement("div",{className:"input-group"},r.a.createElement("select",{className:"form-control",placeholder:e.placeholder||"",onChange:e.onChange,value:e.value,name:e.name,disabled:e.disabled},e.children)))}function h(e){return r.a.createElement("div",{className:"form-group"},"label"in e?r.a.createElement("label",null,e.label||"label"):null,r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{type:e.type||"text",className:"form-control",placeholder:e.placeholder||"",onChange:p(e.state,e.setState),value:null!=e.factor?e.state[e.name]/e.factor:e.state[e.name],list:e.list||"",name:e.name,disabled:e.disabled,"data-factor":e.factor}),"suffix"in e?r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text"},e.suffix)):""))}function g(e){var t=e.handleClose,a=void 0===t?function(){}:t,n=e.editMode,l=void 0!==n&&n,s=e.label,i=void 0===s?"":s;return r.a.createElement("div",{className:"col-12"},r.a.createElement("button",{type:"submit",className:"btn btn-primary mt-2 px-4"},l?"Apply":"Create ".concat(i)),l?r.a.createElement("button",{type:"button",className:"btn btn-secondary mt-2 ml-2 px-4",onClick:a},"Cancel"):"")}function E(e,t,a,n,r,l,s){return function(i){i.preventDefault(),e?fetch("./"+s+"/"+a.id,{method:"put",body:JSON.stringify(a)}):fetch("./"+s,{method:"post",body:JSON.stringify(a)}).then((function(e){return n(r),e.json()})).then((function(e){l(e.id)})),t()}}var y={type:"HTML",interval:300,name:"",url:"",retain_for:7776e3};function N(e){var t=e.onClick;return r.a.createElement("div",{className:"row mt-1"},r.a.createElement("div",{className:"pl-2",style:{width:"48px"}},r.a.createElement("button",{type:"button",className:"btn btn-sm btn-light mr-2",onClick:function(e){e.preventDefault(),null!=t&&t()}},r.a.createElement("span",{className:"fa fa-plus"}))))}function x(e){var t=e.handleRemove,a=e.state,l=e.handleChange,s=e.sensorManager,o=Object(n.useState)(0),m=Object(i.a)(o,2),u=m[0],d=m[1],f=Object(n.useState)({time:0}),v=Object(i.a)(f,2),p=v[0],b=v[1];function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;d((function(t){return t+e}))}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.row,n="".concat(".","/query/").concat(e,"?row=").concat(t);h(),fetch(n).then((function(e){return e.json()})).then((function(e){null!=e[0]&&b(e[0]),h(-1)}))}function E(e){e.preventDefault();var t=Object(c.a)({},a);t[e.nativeEvent.target.name]=e.nativeEvent.target.value,l(t),"id"===e.nativeEvent.target.name&&g(e.nativeEvent.target.value),"row"===e.nativeEvent.target.name&&g(a.id,e.nativeEvent.target.value)}return Object(n.useEffect)((function(){a.id&&g(a.id)}),[a.id]),r.a.createElement("div",{className:"row py-2"},r.a.createElement("div",{className:"pl-2",style:{width:"36px"}},r.a.createElement("button",{type:"button",className:"btn btn-sm btn-light mr-2",onClick:function(e){e.preventDefault(),t()}},r.a.createElement("span",{className:"fa fa-minus"}))),r.a.createElement("div",{className:"pl-2",style:{width:"35%"}},r.a.createElement("select",{className:"form-control form-control-sm mr-2",placeholder:"Sensor",name:"id",value:a.id,onChange:E},r.a.createElement("option",{value:""}),s.items().map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)})))),r.a.createElement("div",{className:"pl-2",style:{width:"35%"}},r.a.createElement("select",{className:"form-control form-control-sm mr-2",placeholder:"Channel",name:"channel",value:a.channel,onChange:E},Object.keys(p).map((function(e){return r.a.createElement("option",{key:e,value:e},e)})))),r.a.createElement("div",{className:"pl-2",style:{width:"20%",maxWidth:"90px"}},r.a.createElement("input",{type:"number",className:"form-control form-control-sm mr-2",placeholder:"-1",name:"row",value:a.row,onChange:E})),r.a.createElement("div",{className:"col-12 mt-1"}),r.a.createElement("div",{className:"pl-2",style:{width:"36px"}}," "),r.a.createElement("div",{className:"pl-2",style:{width:"70%"}},r.a.createElement("div",{className:"input-group input-group-sm"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Variable name (can be used in Expression)",name:"variable",value:a.variable,onChange:E}),r.a.createElement("div",{className:"input-group-append w-50"},r.a.createElement("div",{className:"input-group-text w-100 bg-light"},r.a.createElement("span",{className:"text-truncate text-nowrap text-monospace"},"= ",p[a.channel]))))),r.a.createElement("div",{className:"pl-2",style:{width:"20%",maxWidth:"90px"}},r.a.createElement("button",{type:"button",className:"btn btn-sm btn-light w-100",onClick:function(e){e.preventDefault(),g(a.id)}},u>0?r.a.createElement("i",{className:"spinner-border spinner-border-sm"}):r.a.createElement("i",{className:"fa fa-sync"}))))}function k(e){var t=e.actions,a=e.setActions,n=e.actionManager;return r.a.createElement("div",null,r.a.createElement("ul",{className:"list-group"},t.map((function(e,l){return r.a.createElement("div",{className:"list-group-item p-0",key:l},r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("button",{className:"btn btn-light",type:"button",onClick:function(){return a(t.filter((function(e,t){return l!==t})))}},r.a.createElement("i",{className:"fas fa-minus"}))),r.a.createElement("select",{className:"border-0 custom-select",value:e,onChange:function(e){var n=Object(m.a)(t);n[l]=e.nativeEvent.target.value,a(n)}},n.items().map((function(e,t){return r.a.createElement("option",{value:e.id,key:t},e.name)})))))}))),r.a.createElement("div",{className:"btn btn-light mt-1",onClick:function(){a([].concat(Object(m.a)(t),[n.items().length>0?n.items()[0].id:""]))}},r.a.createElement("i",{className:"fa fa-plus"})))}var S={channel:"time",row:-1,id:"",variable:"A"},w={name:"New Trigger",retain_for:7776e3,expression:"",variables:[S],action_ids:[],message:"",expressionMessage:"",expressionError:!1};function j(e){var t=e.variables,a=e.setVariables,n=e.sensorManager;function l(){if(0===t.length)return S;var e=Object(c.a)({},t.slice(-1)[0]);e.variable=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;function t(e){return e.charAt(Math.floor(Math.random()*e.length))}for(var a="aeoui",n="qwrtzipsdfghjklyxcvbnm",r="",l=0;l<e;l++)r+=t(l%2===0?n:a);return r}(3),a([].concat(Object(m.a)(t),[e]))}return r.a.createElement("div",null,t.map((function(e,l){return r.a.createElement(x,{sensorManager:n,key:l,state:e,handleRemove:function(){a(t.filter((function(e,t){return t!==l})))},handleChange:function(e){var n=Object(m.a)(t);n[l]=e,a(n)}})})),r.a.createElement(N,{onClick:function(){l()}}))}var O={type:"DebugAction",interval:300,name:"",url:"",retain_for:7776e3};function M(e){return r.a.createElement("li",{className:"list-group-item list-group-item-action ".concat(e.active?"active":""),style:{cursor:"default"},onClick:e.onClick},r.a.createElement("span",{style:{width:"48px"}},e.iconLeft),e.children,r.a.createElement("span",{className:"float-right"},e.iconRight))}function C(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),l=a[0],s=a[1];return[r.a.createElement("li",{className:"list-group-item list-group-item-action",onClick:function(){return s(!l)},style:{cursor:"pointer",borderBottom:"none"},key:"1"},r.a.createElement("i",{className:"fas fa-chevron-right fa-sm mr-2",style:l?{transform:"rotate(90deg)"}:{}}),r.a.createElement("span",{className:"text-monospace"},e.label),r.a.createElement("span",{className:"float-right font-weight-light"},e.value)),r.a.createElement("li",{className:"list-group-item custom-collapse ".concat(l?"show":""," py-0"),key:"2"},r.a.createElement("div",{className:"py-3"},l?e.children:null))]}var I=a(9),_=a.n(I);function A(e){if(null!==e)return(e=e.toString()).length<40?e:"".concat(e.slice(0,37),"...")}function P(e){return"".concat(Math.round(e/60*10)/10," minute").concat(60!==e?"s":"")}var L=new Proxy({elapsed:function(e){return"".concat(Math.round(1e3*e)," ms")},time:function(e){return new Date(1e3*e).toLocaleString()},percentage:function(e){return"".concat(Math.round(10*e)/10," %")},seconds:function(e){return"".concat(Math.round(e)," (").concat(Math.round(10*e/60/60/24)/10," days)")},url:function(e){return r.a.createElement("a",{href:decodeURIComponent(e),target:"_blank",rel:"noopener noreferrer"},decodeURIComponent(e))},interval:P,cooldown:P,type:function(e){return r.a.createElement("kbd",{className:"bg-light text-dark"},e)},retain_for:function(e){return"".concat(Math.round(e/24/60/60*10)/10," days")},expression:function(e){return r.a.createElement("div",{className:"text-monospace"},e)},broken:function(e){return e?r.a.createElement("span",{className:"fas fa-times text-danger"}):r.a.createElement("span",{className:"fas fa-check text-success"})},last_notify:function(e){return e<0?"never":"".concat(new Date(1e3*e).toLocaleString()," (").concat(_()(1e3*e).fromNow(),")")},queued_messages:function(e){return e.map((function(e,t){return r.a.createElement("div",{key:t},e)}))},action_ids:function(e){return e.map((function(e,t){return r.a.createElement("kbd",{key:t},e)}))}},{get:function(e,t){return t in e?e[t]:A}}),H=["last_reading","last_update","kwargs","enabled","id","name"],U=new Proxy({url:"Target URL",retain_for:"Retain readings for",last_notify:"Last notified",queued_messages:"Queued messages",api_token:"Api token",user_key:"User key",action_ids:"Actions"},{get:function(e,t){return t in e?e[t]:r.a.createElement("span",{className:"text-capitalize"},t)}});function R(e){return null==e?r.a.createElement("i",{className:"spinner-grow spinner-grow-lg text-secondary mx-auto my-4"}):Object.keys(e).map((function(t){return r.a.createElement(C,{key:t,label:t,value:L[t](e[t])},e[t])}))}function T(e){var t=e.label,a=e.children;return r.a.createElement("li",{className:"list-group-item px-0"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3 h5 text-secondary m-0"},t),r.a.createElement("div",{className:"col-9"},a)))}function D(e){var t=e.stateManager,a=e.FormView,l=e.children,s=Object(o.a)(e,["stateManager","FormView","children"]),m=Object(n.useState)(!1),u=Object(i.a)(m,2),d=u[0],f=u[1];function v(){return t.state().active}function p(){return[r.a.createElement("span",{className:"float-right",key:"buttons"},r.a.createElement("button",{className:"btn btn-light mr-2",onClick:function(){d||(f(!0),t.refreshItem(v()).then((function(){f(!1)})))},disabled:t.activeState().editMode},d?r.a.createElement("i",{className:"spinner-border spinner-border-sm"}):r.a.createElement("i",{className:"fa fa-sync"})),r.a.createElement("button",{className:"btn btn-light mr-2",onClick:function(){return t.setActiveState({editMode:!t.activeState().editMode})}},r.a.createElement("i",{className:"fa fa-edit"})),r.a.createElement("button",{className:"btn btn-light",onClick:function(){return t.deleteItem(v())}},r.a.createElement("i",{className:"fa fa-trash text-danger"}))),r.a.createElement("div",{className:"mb-4",key:"spacer"})]}function b(e){t.setActiveState({formState:Object(c.a)({},t.activeState().formState,{},e)})}return Object(n.useEffect)((function(){null==t.item().last_reading&&t.updateItem(v())}),[v()]),!0===t.activeState().editMode?[p(),r.a.createElement(a,Object.assign({key:"form",state:Object(c.a)({},t.item(),{},t.activeState().formState),setState:b,editMode:!0,handleClose:function(){t.setActiveState({editMode:!1,formState:{}})}},s))]:[p(),r.a.createElement("div",{key:"detail"},function(e){var t={variables:function(e){return e.map((function(e,t){var a=e.id;try{a=s.sensorManager.items().find((function(t){return t.id===e.id})).name}catch(n){}return r.a.createElement("div",{className:"text-monospace text-large",key:t},r.a.createElement("code",{className:""},e.variable)," = ",r.a.createElement("kbd",null,a),".",r.a.createElement("kbd",null,e.channel),"[",r.a.createElement("kbd",null,e.row),"]")}))}};return r.a.createElement("ul",{className:"list-group list-group-flush"},Object.entries(e).map((function(e){var a=e[0],n=e[1];return null!=n&&""!==n&&!H.includes(a)&&r.a.createElement(T,{label:U[a],key:a},a in t?t[a](n):L[a](n))})))}(t.item()),l)]}var V=function(){function e(){Object(d.a)(this,e),this.subscriptions=[],this.listen()}return Object(f.a)(e,[{key:"subscribe",value:function(e){this.subscriptions.push(e)}},{key:"unsubscribe",value:function(e){var t=this.subscriptions.indexOf(e);delete this.subscriptions[t]}},{key:"handleEvent",value:function(e){this.subscriptions.forEach((function(t){try{t.eventHandler(e)}catch(a){console.log(a)}}))}},{key:"listen",value:function(){var e=this;new EventSource("./events").onmessage=function(t){try{var a=JSON.parse(t.data);e.handleEvent(a)}catch(n){}}}}]),e}();function F(e){var t,a=e.stateManager;return Object(n.useEffect)((function(){null==a.state().active&&null!=a.items()[0]&&a.setState({active:a.items()[0].id})}),[a.state().active,a.items()]),[r.a.createElement("li",{className:"list-group-item list-group-item-action ".concat("form"===a.state().active?"active":""),key:"button",style:{cursor:"default"},onClick:function(){return a.setState({active:"form"})}},r.a.createElement("h3",{className:"mb-1"},"New ",a.itemLabel,r.a.createElement("span",{className:"float-right"},r.a.createElement("i",{className:"fa fa-xs fa-plus"})))),r.a.createElement("input",{className:"bg-light input-group-sm list-group-item w-100 icon-placeholder py-2",placeholder:"\uf002 Filter",value:a.state().filter,key:"Filter",onChange:function(e){return a.setState({filter:e.target.value})}}),(t=a.items().filter((function(e){var t=(a.state().filter||"").toLowerCase();return Object.keys(e).some((function(a){try{return e[a].toLowerCase().includes(t)}catch(n){return!1}}))})),null==t?null:t.map((function(e){return r.a.createElement(M,{key:e.id,onClick:function(){return a.setState({active:e.id})},active:a.state().active===e.id,iconRight:r.a.createElement("div",{className:"badge badge-light font-weight-normal"},e.type)},e.name)})))]}var G=a(10),z=a.n(G);a(23),r.a.memo((function(e){var t={responsive:!0,hoverMode:"index",stacked:!1,title:{display:!0,text:e.title||""},scales:{yAxes:[{type:"linear",display:!0,position:"left",id:"y-axis-1"},{type:"linear",display:!1,position:"right",id:"y-axis-2",gridLines:{drawOnChartArea:!1}}],xAxes:[{type:"time"}]},plugins:{zoom:{pan:{enabled:!1},zoom:{enabled:!0,drag:!0,mode:"x",speed:1,threshold:.1}}}},a=!1;Object(n.useEffect)((function(){a||(!function(){var a=z.a.Line(l.current,{data:(n=e.data,{labels:n.map((function(e,t){return t})),datasets:[{label:"My First dataset",borderColor:"#fa9121",backgroundColor:"#fa912111",fill:!0,data:n,hidden:!0},{label:"My Second dataset",borderColor:"#21af61",backgroundColor:"#21af61",fill:!1,data:n.map((function(e){return 1.2*e}))}]}),options:t});var n;l.current.ondblclick=function(){a.resetZoom()}}(),a=!0)}),[e.data]);var l=r.a.createRef();return r.a.createElement("canvas",{ref:l})}));function J(e){return r.a.createElement("div",{className:"col-md-4 col-lg-3 px-0 bg-secondary border-right shadow"},r.a.createElement("ul",{className:"list-group list-group-flush flex-column"},e.children))}function K(e){return r.a.createElement("div",{className:"col-md-8 col-lg-9 vh-100 py-3 mx-0",style:{overflow:"scroll"}},e.children)}function q(e){var t=e.FormView,a=e.stateManager,n=e.children,l=Object(o.a)(e,["FormView","stateManager","children"]);function s(e){a.setState({formState:Object(c.a)({},a.state().formState,{},e)})}return r.a.createElement("div",null,r.a.createElement("span",{className:"h2 text-dark mb-4"},a.item().name||""),"form"===a.state().active?r.a.createElement(t,Object.assign({state:a.state().formState,setState:s,setActive:function(e){a.setState({active:e})}},l)):r.a.createElement(D,Object.assign({stateManager:a,FormView:t},l),n))}var W=new V,B={sensors:{manager:new v({eventManager:W,itemLabel:"Sensor",basicEventHandlerItemPrefix:"sensor",fetchUrlPath:"/sensors"}),form:function(e){var t=e.editMode,a=void 0!==t&&t,n=e.state,l=void 0===n?y:n,s=e.setState,i=e.handleClose,c=void 0===i?function(){}:i,m=e.setActive,u=void 0===m?function(e){}:m,d=(Object(o.a)(e,["editMode","state","setState","handleClose","setActive"]),E(a,c,l,s,y,u,"sensors")),f={state:l,setState:s};return r.a.createElement("form",{onSubmit:d,className:"row"},r.a.createElement("div",{className:"col-lg-4",style:{borderRight:"1px solid #dee2e6"}},r.a.createElement("h4",null,"Type"),r.a.createElement(b,{label:" ",type:"select",value:l.type,list:"form-add-sensor-types",name:"type",onChange:p(l,s),disabled:a},r.a.createElement("option",{value:"HTML"},"HTML - Grabs HTTP response from a URL"),r.a.createElement("option",{value:"CPUPercentage"},"CPUPercentage - Host system CPU usage"),r.a.createElement("option",{value:"RAMPercentage"},"RAMPercentage - Host system memory usage"),r.a.createElement("option",{value:"Uptime"},"Uptime - Host system uptime"))),r.a.createElement("div",{className:"col-lg-4",style:{borderRight:"1px solid #dee2e6"}},r.a.createElement("h4",null,"Info"),r.a.createElement(h,Object.assign({},f,{label:"Name:",name:"name"})),r.a.createElement(h,Object.assign({},f,{label:"Update interval:",name:"interval",type:"number",suffix:"minutes",factor:60})),r.a.createElement(h,Object.assign({},f,{label:"Retain for:",name:"retain_for",type:"number",suffix:"days",factor:86400}))),r.a.createElement("div",{className:"col-lg-4"},r.a.createElement("h4",null,"Type Specific Info"),"HTML"===l.type?r.a.createElement(h,Object.assign({label:"Target URL:",name:"url"},f)):""),r.a.createElement(g,{handleClose:c,editMode:a,label:"Sensor"}))},moreInfo:function(e){var t=e.stateManager,a=t.state().activeDetailView||0,n=function(e){t.setState({activeDetailView:e})};return r.a.createElement("div",{className:"mt-3"},"HTML"===t.item().type&&r.a.createElement("button",{className:"btn btn-sm btn-outline-primary mb-2",onClick:function(){window.open(t.item().url).document.write(t.item().last_reading.content)}},r.a.createElement("span",{className:"fa fa-external-link-alt mr-2"}),"Open HTML content of last reading in new window"),r.a.createElement("div",{className:"btn-group mb-2 w-100"},r.a.createElement("button",{type:"button",className:"btn btn-light ".concat(0===a?"active":""),onClick:function(){n(0)}},r.a.createElement("span",{className:"fas fa-database mr-2"}),"Raw Data"),r.a.createElement("button",{type:"button",className:"btn btn-light ".concat(1===a?"active":""),onClick:function(){n(1)}},r.a.createElement("span",{className:"fas fa-chart-area mr-2"}),"History")),0===a&&r.a.createElement("div",null,r.a.createElement("ul",{className:"list-group"},R(t.item().last_reading)),r.a.createElement("span",{className:"text-muted font-weight-normal"},"data from last reading")),1===a&&r.a.createElement("div",null,"Work in progress"))}},triggers:{manager:new v({eventManager:W,itemLabel:"Trigger",basicEventHandlerItemPrefix:"trigger",fetchUrlPath:"/triggers"}),form:function(e){var t=e.editMode,a=void 0!==t&&t,l=e.state,s=void 0===l?w:l,i=e.setState,o=e.handleClose,m=void 0===o?function(){}:o,u=e.setActive,d=void 0===u?function(){}:u,f=e.actionManager,v=e.sensorManager;Object(n.useEffect)((function(){""!==s.expression&&function(e,t){var a={expression:e,variables:t};fetch("./evaluate",{method:"post",body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(e){i(Object(c.a)({},s,{expressionMessage:e.message,expressionError:e.error}))}))}(s.expression,s.variables)}),[s.expression,s.variables]);var p=E(a,m,s,i,w,d,"triggers"),b={state:s,setState:i};return r.a.createElement("form",{onSubmit:p},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement(h,Object.assign({label:"Name:",name:"name"},b))),r.a.createElement("div",{className:"col-md-6"},r.a.createElement(h,Object.assign({label:"Retain history for:",type:"number",name:"retain_for",suffix:"days",factor:86400},b)))),r.a.createElement("hr",null),r.a.createElement("h4",null,"Variables"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{style:{width:"36px"},className:"px-2"}," "),r.a.createElement("div",{style:{width:"35%"},className:"px-2"},"Sensor:"),r.a.createElement("div",{style:{width:"35%"},className:"px-2"},"Channel:"),r.a.createElement("div",{style:{width:"20%",maxWidth:"90px"},className:"px-2"},"Index:")),r.a.createElement(j,{sensorManager:v,variables:s.variables,setVariables:function(e){i(Object(c.a)({},s,{variables:e}))}}),r.a.createElement("hr",null),r.a.createElement("h4",null,"Expression"),r.a.createElement(h,Object.assign({type:"text",className:"form-control text-monospace mb-1",placeholder:'A == 3 or "substing" in long_string',name:"expression"},b)),""===s.expression?null:r.a.createElement("div",{className:"alert ".concat(s.expressionError?"alert-danger":[!0,!1].includes(s.expressionMessage)?"alert-success":"alert-warning")},"expressionMessage"in s&&s.expressionMessage.toString()),r.a.createElement("h4",null,"Action"),r.a.createElement(k,{actionManager:f,actions:s.action_ids,setActions:function(e){i(Object(c.a)({},s,{action_ids:e}))}}),r.a.createElement(h,Object.assign({label:"Message:",name:"message"},b)),r.a.createElement(g,{label:"Trigger",handleClose:m,editMode:a}))},moreInfo:function(e){var t=e.stateManager;return r.a.createElement("div",{className:"mt-3"},r.a.createElement("h4",null,"Last Check"),r.a.createElement("ul",{className:"list-group"},R(t.item().last_reading)))}},actions:{manager:new v({eventManager:W,itemLabel:"Action",basicEventHandlerItemPrefix:"action",fetchUrlPath:"/actions"}),form:function(e){var t=e.editMode,a=void 0!==t&&t,n=e.state,l=void 0===n?O:n,s=e.setState,i=e.handleClose,c=void 0===i?function(){}:i,m=e.setActive,u=void 0===m?function(e){}:m,d=(Object(o.a)(e,["editMode","state","setState","handleClose","setActive"]),E(a,c,l,s,O,u,"actions")),f={state:l,setState:s};return r.a.createElement("form",{onSubmit:d,className:"row"},r.a.createElement("div",{className:"col-lg-4",style:{borderRight:"1px solid #dee2e6"}},r.a.createElement("h4",null,"Type"),r.a.createElement(b,{label:" ",type:"select",value:l.type,list:"form-add-sensor-types",name:"type",onChange:p(l,s),disabled:a},r.a.createElement("option",{value:"DebugAction"},"DebugAction - Debug print statement"),r.a.createElement("option",{value:"PushoverAction"},"Pushover - Sends a push notification"))),r.a.createElement("div",{className:"col-lg-4",style:{borderRight:"1px solid #dee2e6"}},r.a.createElement("h4",null,"Info"),r.a.createElement(h,Object.assign({label:"Name:",name:"name"},f)),r.a.createElement(h,Object.assign({label:"Cooldown:",name:"cooldown",type:"number",suffix:"minutes",factor:60},f)),r.a.createElement(h,Object.assign({label:"Retain for:",name:"retain_for",type:"number",suffix:"days",factor:86400},f))),r.a.createElement("div",{className:"col-lg-4"},r.a.createElement("h4",null,"Type Specific Info"),"PushoverAction"===l.type?[r.a.createElement(h,Object.assign({label:"Api token:",name:"api_token",key:"api_token"},f)),r.a.createElement(h,Object.assign({label:"User key:",name:"user_key",key:"user_key"},f)),r.a.createElement(h,Object.assign({label:"Device:",name:"device",key:"device"},f))]:""),r.a.createElement(g,{editMode:a,handleClose:c,label:"Action"}))},moreInfo:function(e){var t=e.stateManager;return r.a.createElement("div",{className:"mt-3"},r.a.createElement("h4",null,"Last Message"),r.a.createElement("ul",{className:"list-group"},R(t.item().last_reading)))}}};function Q(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],l=t[1];function s(e){l(Object(c.a)({},a,{},e))}Object.keys(B).map((function(e){B[e].manager.initializeGlobalState(a,s)}));var o=Object(n.useState)("sensors"),m=Object(i.a)(o,2),u=m[0],d=m[1];var f=B[u].manager,v=B[u].moreInfo;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement(J,null,r.a.createElement("li",{className:"list-group-item bg-secondary p-2"},r.a.createElement("div",{className:"btn-group w-100"},function(){var e={sensors:r.a.createElement("span",{className:"fas fa-ruler-vertical mr-2"}),triggers:r.a.createElement("span",{className:"fas fa-calculator mr-2"}),actions:r.a.createElement("span",{className:"fas fa-bullseye mr-2"})};return Object.keys(B).map((function(t){return r.a.createElement("button",{type:"button",className:"btn btn-light px-1 text-capitalize ".concat(u===t?"active":""),key:t,onClick:function(){d(t)}},e[t],r.a.createElement("br",null),t)}))}())),r.a.createElement(F,{stateManager:f})),r.a.createElement(K,null,r.a.createElement(q,{stateManager:f,FormView:B[u].form,sensorManager:B.sensors.manager,actionManager:B.actions.manager},r.a.createElement(v,{stateManager:f})))))}s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Q,null)),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.1ada5f60.chunk.js.map